---
$id: http://qubership.org/schemas/product/qip/element/context-storage.schema.yaml
$schema: http://json-schema.org/draft-07/schema
type: object
allOf:
  - $ref: "http://qubership.org/schemas/product/qip/element/properties/common-element-properties.schema.yaml"
title: Context Storage
properties:
  type:
    type: string
    const: context-storage
  properties:
    type: object
    properties:
      contextServiceId:
        type: string
        title: Context Service
      contextId:
        type: string
        title: Context ID
      useCorrelationId:
        type: boolean
        title: Use correlation ID as session context ID
      operation:
        type: string
        enum:
          - GET
          - DELETE
          - SET
        title: Operation
      ttl:
        type: integer
        title: Time to live
        description: Session context life time (in seconds).

    if:
      properties:
        operation:
          const: SET
    then:
      properties:
        key:
          type: string
          title: Key
        value:
          type: string
          title: Value
      required:
        - key
        - value
    else:
      if:
        properties:
          operation:
            const: GET
      then:
        properties:
          keys:
            type: string
            title: Keys
          target:
            type: string
            enum:
              - BODY
              - HEADER
              - PROPERTY
            title: Target
          targetName:
            type: string
            title: Target name
          unwrap:
            type: boolean
            title: Unwrap
        required:
          - target
    required:
      - contextServiceId
      - useCorrelationId
      - operation
required:
  - type
